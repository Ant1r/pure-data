#N canvas 372 54 733 807 12;
#X declare -stdpath ./;
#N canvas 0 0 450 300 (subpatch) 0;
#X array E01-signal 882 float 0;
#X coords 0 6 882 -6 247 147 1 0 0;
#X restore 417 49 graph;
#X obj 119 338 hip~ 5;
#N canvas 0 0 450 300 (subpatch) 0;
#X array E01-spectrum 90 float 0;
#X coords 0 4300 89 -40 255 130 1 0 0;
#X restore 412 290 graph;
#N canvas 310 109 540 689 fft 0;
#X obj 163 92 inlet~;
#X obj 298 92 inlet;
#X obj 163 122 rfft~;
#X obj 163 155 *~;
#X obj 195 155 *~;
#X obj 163 185 sqrt~;
#X obj 298 301 tabwrite~ E01-spectrum;
#X obj 163 222 biquad~ 0 0 0 0 1;
#X text 53 122 Fourier series;
#X text 36 10 This subpatch computes the spectrum of the incoming signal with a (rectangular windowed) FFT. FFTs aren't properly introduced until much later., f 66;
#X text 31 93 signal to analyze;
#X obj 176 481 samplerate~;
#X obj 176 455 bng 18 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X floatatom 176 533 5 0 0 0 - - - 0;
#X obj 176 506 / 256;
#X obj 176 431 loadbang;
#X floatatom 176 615 9 0 0 0 - - - 0;
#X obj 184 561 s fundamental;
#X obj 176 588 ftom;
#X text 66 357 At load time \, calculate a good choice of fundamental frequency for showing spectra: the 16th bin in a 4096-point spectrum \, so SR*16/4096 or SR/256., f 62;
#X text 355 87 "bang" into this inlet to graph it, f 18;
#X text 253 616 <-- just out of curiosity \, here's the pitch, f 17;
#X obj 354 214 block~ 4096;
#X text 79 214 delay two samples for better graphing, f 10;
#X text 86 162 calculate magnitude, f 9;
#X text 351 174 FFT Window size of 4096, f 12;
#X connect 0 0 2 0;
#X connect 1 0 6 0;
#X connect 2 0 3 0;
#X connect 2 0 3 1;
#X connect 2 1 4 0;
#X connect 2 1 4 1;
#X connect 3 0 5 0;
#X connect 4 0 5 0;
#X connect 5 0 7 0;
#X connect 7 0 6 0;
#X connect 11 0 14 0;
#X connect 12 0 11 0;
#X connect 13 0 17 0;
#X connect 13 0 18 0;
#X connect 14 0 13 0;
#X connect 15 0 12 0;
#X connect 18 0 16 0;
#X restore 131 303 pd fft;
#X text 472 207 ---- 0.02 seconds ----;
#X obj 191 268 bng 19 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X obj 119 372 output~;
#X obj 191 303 tabwrite~ E01-signal;
#X text 506 763 updated for Pd version 0.37;
#X text 458 423 1;
#X text 504 423 2;
#X text 549 423 3;
#X text 595 423 4;
#X text 641 423 5;
#X text 413 423 0;
#X text 673 114 0;
#X obj 119 65 r fundamental;
#X obj 33 131 osc~;
#X obj 33 185 *~;
#X obj 76 131 osc~;
#X obj 76 185 *~;
#X obj 119 131 osc~;
#X obj 119 185 *~;
#X obj 162 131 osc~;
#X obj 162 185 *~;
#X obj 205 131 osc~;
#X obj 205 185 *~;
#X obj 248 131 osc~;
#X obj 248 185 *~;
#X text 547 17 WAVEFORM;
#X text 672 408 0;
#X text 670 287 1;
#X text 671 346 0.5;
#X text 25 643 The upper graph is just the (time domain) waveform \, about four periods long. The lower graph is the magnitude spectrum. Its peaks are the magnitudes of the partials. Note that a DC signal of amplitude one is considered a partial of magnitude 1 \, but the other partials \, which have peak amplitudes of 1 (and RMS 0.707) \, have peak magnitudes of only 0.5 in the spectrum., f 95;
#X obj 119 242 *~ 1;
#X text 85 242 sum;
#X text 50 22 GRAPHING SPECTRA OF AUDIO SIGNALS;
#X obj 112 450 declare -stdpath ./;
#X text 214 267 <-- click to graph;
#X text 25 708 Here we're introducing a new feature: multiple signals connected to a signal inlet (as in the [*~ 1]) are added. This is the most convenient way to sum the six partials., f 95;
#X obj 51 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 94 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 137 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 180 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 223 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 266 160 tgl 18 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X text 672 46 6;
#X text 668 185 -6;
#X text 25 498 The next series of patches demonstrates various kinds of modulation: AM \, waveshaping \, and FM. We will need a tool for graphing spectra which is introduced here. In this patch the signal to be analyzed is a simple sum of up to six partials of a fundamental frequency (which is 172 Hz \, close to F below middle C \, if your sample rate happens to be 44100 Hz. The fundamental is chosen to agree with the analysis patch ([pd FFT]) and is computed within it., f 95;
#X obj 33 104 * 0;
#X obj 76 104 * 1;
#X obj 119 104 * 2;
#X obj 162 104 * 3;
#X obj 205 104 * 4;
#X obj 248 104 * 5;
#X text 25 577 The partials are the multipliers in the [*] objects and go from 0 through 5 \, where 0 means DC (or 0 Hz frequency) \, 1 is the fundamental \, and so on. The toggle switches allow you to turn them on and off separately. You have to press the "click to graph" button to update the two graphs., f 95;
#X text 290 160 <--;
#X text 316 160 On/Off for each partial, f 8;
#X text 538 262 SPECTRAL ANALYSIS;
#X text 449 452 ------ partial number ------;
#X connect 1 0 6 0;
#X connect 5 0 3 1;
#X connect 5 0 7 0;
#X connect 16 0 49 0;
#X connect 16 0 50 0;
#X connect 16 0 51 0;
#X connect 16 0 52 0;
#X connect 16 0 53 0;
#X connect 16 0 54 0;
#X connect 17 0 18 0;
#X connect 18 0 34 0;
#X connect 19 0 20 0;
#X connect 20 0 34 0;
#X connect 21 0 22 0;
#X connect 22 0 34 0;
#X connect 23 0 24 0;
#X connect 24 0 34 0;
#X connect 25 0 26 0;
#X connect 26 0 34 0;
#X connect 27 0 28 0;
#X connect 28 0 34 0;
#X connect 34 0 3 0;
#X connect 34 0 1 0;
#X connect 34 0 7 0;
#X connect 40 0 18 1;
#X connect 41 0 20 1;
#X connect 42 0 22 1;
#X connect 43 0 24 1;
#X connect 44 0 26 1;
#X connect 45 0 28 1;
#X connect 49 0 17 0;
#X connect 50 0 19 0;
#X connect 51 0 21 0;
#X connect 52 0 23 0;
#X connect 53 0 25 0;
#X connect 54 0 27 0;
