#N canvas 433 119 793 595 12;
#X declare -stdpath ./;
#N canvas 0 0 450 300 (subpatch) 0;
#X array F05-signal 882 float 0;
#X coords 0 1 882 -1 200 130 1;
#X restore 507 300 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array F05-spectrum 256 float 0;
#X coords 0 0.51 255 -0.008 256 130 1;
#X restore 457 50 graph;
#X text 523 437 ---- 0.02 seconds ----;
#X text 453 183 0;
#X text 719 170 0;
#X text 716 47 0.5;
#X floatatom 89 57 5 0 100 0 - - - 0;
#N canvas 667 118 574 518 pulse-train 0;
#X obj 229 289 line~;
#X obj 99 368 cos~;
#X obj 229 265 pack 0 50;
#X obj 99 246 -~ 0.5;
#X obj 99 300 *~;
#X obj 183 183 / 10;
#X obj 183 207 moses 0;
#X msg 183 231 0;
#X obj 99 344 clip~ -0.5 0.5;
#X obj 229 313 +~ 1;
#X obj 99 392 +~ 1;
#X obj 183 159 inlet;
#X obj 99 460 outlet~;
#X obj 99 416 *~ 0.5;
#X text 57 23 This is a modified version of the pulse train generator from two examples back.;
#X text 56 72 We have to add 1/2 and wrap so that the center of the pulse comes at phase zero (previously it was 1/2 cycle out of phase). This wasn't a problem before but now we have to be in phase with the oscillator we're multiplying with.;
#X text 262 160 otherwise it's the same as before.;
#X obj 99 202 phasor~;
#X obj 99 175 r freq;
#X connect 0 0 9 0;
#X connect 1 0 10 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 8 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 6 1 2 0;
#X connect 7 0 2 0;
#X connect 8 0 1 0;
#X connect 9 0 4 1;
#X connect 10 0 13 0;
#X connect 11 0 5 0;
#X connect 13 0 12 0;
#X connect 17 0 3 0;
#X connect 18 0 17 0;
#X restore 89 82 pd pulse-train;
#X obj 89 225 *~;
#X text 189 140 multiple of fundamental;
#X obj 89 292 output~;
#X obj 166 228 bng 19 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X obj 207 254 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X text 485 183 2;
#X text 517 183 4;
#X text 549 183 6;
#X text 581 183 8;
#X text 614 183 10;
#X text 646 183 12;
#X text 677 183 14;
#X text 712 295 1;
#X text 712 419 -1;
#X text 156 196 modulating oscillator;
#X text 69 371 Now we take a pulse train and ring modulate it \, which effectively aliases the spectrum so that it is centered at any desired partial number. The "bandwidth" control still affects the shape of the peak \, independently of where it is centered. This generates a formant centered at the given partial., f 55;
#X floatatom 107 127 6 0 100 0 - - - 0;
#X obj 107 193 osc~;
#X obj 107 165 *;
#X obj 141 165 r freq;
#X text 69 467 This patch is limited to making formants centered on harmonics. The center frequency thus can't be moved smoothly up and down at will (try shift-clicking on modulation frequency to make fractions). Next we'll look at two techniques for sliding a formant frequency without losing harmonicity., f 55;
#X text 201 97 generator from before;
#X obj 234 312 declare -stdpath ./;
#X text 188 228 <-- graph once;
#X text 228 253 <-- repeatedly;
#X text 140 57 <-- bandwidth;
#X text 202 81 <-- pulse train;
#X text 161 126 <-- modulation frequency as;
#X obj 89 258 hip~ 5;
#N canvas 715 281 537 493 fft 0;
#X obj 43 105 inlet~;
#X obj 142 264 inlet;
#X obj 63 136 rfft~;
#X obj 63 169 *~;
#X obj 95 169 *~;
#X obj 63 199 sqrt~;
#X obj 63 225 biquad~ 0 0 0 0 1;
#X text 127 137 Fourier series;
#X text 132 190 magnitude;
#X text 130 175 calculate;
#X text 60 26 This subpatch computes the spectrum of the incoming signal with a (rectangular windowed) FFT. FFTs aren't properly introduced until much later.;
#X text 105 104 signal to analyze;
#X text 194 216 delay two samples;
#X text 192 234 for better graphing;
#X obj 383 280 samplerate~;
#X obj 383 303 / 256;
#X obj 178 328 metro 500;
#X obj 178 292 inlet;
#X text 231 290 toggle to graph repeatedly, f 15;
#X text 185 264 bang to graph once;
#X obj 63 249 /~ 4096;
#X obj 383 357 s freq;
#X obj 366 153 block~ 4096;
#X text 368 126 Window size;
#X floatatom 383 329 10 0 0 0 - - - 0;
#X obj 383 255 loadbang;
#X obj 142 360 b;
#X obj 143 396 tabwrite~ F05-spectrum;
#X obj 43 422 tabwrite~ F05-signal;
#X connect 0 0 2 0;
#X connect 0 0 28 0;
#X connect 1 0 26 0;
#X connect 2 0 3 0;
#X connect 2 0 3 1;
#X connect 2 1 4 0;
#X connect 2 1 4 1;
#X connect 3 0 5 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 20 0;
#X connect 14 0 15 0;
#X connect 15 0 24 0;
#X connect 16 0 26 0;
#X connect 17 0 16 0;
#X connect 20 0 27 0;
#X connect 24 0 21 0;
#X connect 25 0 14 0;
#X connect 26 0 27 0;
#X connect 26 0 28 0;
#X restore 147 254 pd fft;
#X text 481 211 ------ partial number ------;
#X obj 35 20 cnv 5 5 25 empty empty Ring\ Modulated\ Pulse\ Trains 15 13 0 16 #dfdfdf #202020 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 36 0;
#X connect 8 0 37 0;
#X connect 11 0 37 1;
#X connect 12 0 37 2;
#X connect 24 0 26 0;
#X connect 25 0 8 1;
#X connect 26 0 25 0;
#X connect 27 0 26 1;
#X connect 36 0 10 0;
