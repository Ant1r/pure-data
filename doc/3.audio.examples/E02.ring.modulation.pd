#N canvas 425 38 743 743 12;
#X declare -stdpath ./;
#N canvas 0 0 450 300 (subpatch) 0;
#X array E02-signal 882 float 0;
#X coords 0 6 882 -6 257 131 1 0 0;
#X restore 404 206 graph;
#X obj 115 490 hip~ 5;
#N canvas 0 0 450 300 (subpatch) 0;
#X array E02-spectrum 128 float 0;
#X coords 0 4300 127 -40 257 130 1;
#X restore 402 415 graph;
#X obj 189 469 bng 19 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X obj 115 531 output~;
#X text 433 548 1;
#X text 467 548 2;
#X text 499 548 3;
#X text 531 548 4;
#X text 564 548 5;
#X text 594 548 6;
#X text 625 548 7;
#X text 401 548 0;
#X text 666 263 0;
#X obj 116 174 r fundamental;
#X obj 29 232 osc~;
#X obj 29 282 *~;
#X obj 73 232 osc~;
#X obj 73 282 *~;
#X obj 116 232 osc~;
#X obj 116 282 *~;
#X obj 116 209 * 2;
#X obj 159 232 osc~;
#X obj 159 282 *~;
#X obj 202 232 osc~;
#X obj 202 282 *~;
#X obj 245 232 osc~;
#X obj 245 282 *~;
#X obj 29 209 * 0;
#X obj 73 209 * 1;
#X obj 159 209 * 3;
#X obj 202 209 * 4;
#X obj 245 209 * 5;
#X text 562 176 WAVEFORM;
#X text 550 392 SPECTRUM;
#X text 662 531 0;
#X text 660 410 1;
#X text 661 469 0.5;
#X obj 116 359 *~;
#X text 307 240 partials;
#X obj 234 390 osc~;
#X floatatom 234 330 4 0 200 0 - - - 0;
#X obj 234 359 *;
#X obj 267 359 r freq-step;
#X obj 189 421 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 189 445 metro 500;
#X text 63 628 If you choose a multiple of the fundamental as a modulation frequency (16 \, 32 \, 48 \, 64 \, ... "steps") the result is again periodic at the original frequency. If you select a half-integer times the fundamental (8 \, 24 \, 40 \, ... steps) the pitch drops by an octave and you get only odd partials. For most other settings you'll get an inharmonic complex of tones. These are sometimes heard as separate pitches and other times they seem to fuse into a single timbre with indeterminate pitch., f 89;
#N canvas 436 82 601 665 fft 0;
#X obj 86 90 inlet~;
#X obj 162 243 inlet;
#X obj 96 121 rfft~;
#X obj 96 154 *~;
#X obj 128 154 *~;
#X obj 96 184 sqrt~;
#X obj 96 210 biquad~ 0 0 0 0 1;
#X text 160 122 Fourier series;
#X text 64 24 This subpatch computes the spectrum of the incoming signal with a (rectangular windowed) FFT. FFTs aren't properly introduced until much later.;
#X text 150 90 signal to analyze;
#X text 235 202 delay two samples;
#X text 234 218 for better graphing;
#X obj 91 466 samplerate~;
#X obj 91 443 bng 18 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X floatatom 91 523 5 0 0 0 - - - 0;
#X obj 91 499 / 256;
#X obj 91 419 loadbang;
#X floatatom 91 592 9 0 0 0 - - - 0;
#X obj 99 545 s fundamental;
#X obj 91 568 ftom;
#X text 70 353 At load time \, calculate a good choice of fundamental frequency for showing spectra: the 16th bin in a 4096-point spectrum \, so SR*16/4096 or SR/256., f 62;
#X text 212 245 "bang" into this inlet to graph it;
#X floatatom 230 531 8 0 0 0 - - - 0;
#X obj 230 507 / 4096;
#X text 226 476 One bin is SR/4096:;
#X obj 230 553 s freq-step;
#X obj 162 277 tabwrite~ E02-spectrum;
#X obj 87 310 tabwrite~ E02-signal;
#X obj 399 138 block~ 4096;
#X text 163 592 <-- just out of curiosity \, here's the fundamental pitch;
#X text 398 113 Window size;
#X text 163 157 calculate magnitude, f 9;
#X connect 0 0 2 0;
#X connect 0 0 27 0;
#X connect 1 0 26 0;
#X connect 1 0 27 0;
#X connect 2 0 3 0;
#X connect 2 0 3 1;
#X connect 2 1 4 0;
#X connect 2 1 4 1;
#X connect 3 0 5 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 26 0;
#X connect 12 0 15 0;
#X connect 12 0 23 0;
#X connect 13 0 12 0;
#X connect 14 0 18 0;
#X connect 14 0 19 0;
#X connect 15 0 14 0;
#X connect 16 0 13 0;
#X connect 19 0 17 0;
#X connect 22 0 25 0;
#X connect 23 0 22 0;
#X restore 128 457 pd fft;
#X obj 490 27 declare -stdpath ./;
#X text 212 420 <-- graph repeatedly;
#X text 212 468 <-- graph once;
#X text 289 256 <-- On/Off;
#X obj 47 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 91 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 134 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 177 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 220 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X obj 263 257 tgl 19 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000 0 1;
#X text 666 200 6;
#X text 667 325 -6;
#X text 433 579 ------ partial number --------;
#X text 432 343 ------ 0.02 seconds ------;
#X text 43 66 Now we ring modulate the signal by multiplying it by another sinusoid. The modulation frequency is controlled in steps of f/16 where "f" is the fundamental frequency \, giving roughly 11 Hz per step. Note that if the modulation frequency is set to zero we can't predict the overall amplitude because it depends on what phase the modulation oscillator happened to have at that moment., f 88;
#X obj 85 21 cnv 5 5 25 empty empty Ring\ Modulation 15 13 0 16 #dfdfdf #202020 0;
#X text 294 286 modulation frequency in "steps" of f/16, f 10;
#X text 268 329 <--;
#X connect 1 0 4 0;
#X connect 3 0 47 1;
#X connect 14 0 28 0;
#X connect 14 0 29 0;
#X connect 14 0 21 0;
#X connect 14 0 30 0;
#X connect 14 0 31 0;
#X connect 14 0 32 0;
#X connect 15 0 16 0;
#X connect 16 0 38 0;
#X connect 17 0 18 0;
#X connect 18 0 38 0;
#X connect 19 0 20 0;
#X connect 20 0 38 0;
#X connect 21 0 19 0;
#X connect 22 0 23 0;
#X connect 23 0 38 0;
#X connect 24 0 25 0;
#X connect 25 0 38 0;
#X connect 26 0 27 0;
#X connect 27 0 38 0;
#X connect 28 0 15 0;
#X connect 29 0 17 0;
#X connect 30 0 22 0;
#X connect 31 0 24 0;
#X connect 32 0 26 0;
#X connect 38 0 1 0;
#X connect 38 0 47 0;
#X connect 40 0 38 1;
#X connect 41 0 42 0;
#X connect 42 0 40 0;
#X connect 43 0 42 1;
#X connect 44 0 45 0;
#X connect 45 0 3 0;
#X connect 52 0 16 1;
#X connect 53 0 18 1;
#X connect 54 0 20 1;
#X connect 55 0 23 1;
#X connect 56 0 25 1;
#X connect 57 0 27 1;
